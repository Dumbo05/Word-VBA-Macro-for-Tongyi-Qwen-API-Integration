# 适用于通义千问API集成的Word VBA宏

## 概述

本项目提供了一个简单的VBA宏解决方案，适用于希望在文档中直接集成由AI驱动的文本生成功能的Microsoft Word用户。该宏允许用户选择Word中的任何文本部分发送到通义千问API，并接收和插入由AI生成的内容回到文档中。此外，它确保了响应中的换行符（`\n`）被正确处理并转换为Word原生的换行符。

## 特性

- **文本选择**：用户可以选择Word中的任意文本部分发送给通义千问API。
- **API集成**：向指定的通义千问API端点发送选定文本并获取响应。
- **换行处理**：将API响应中的换行符（`\n`）转换为Word兼容的换行符（`vbCrLf`）。
- **错误处理**：如果API请求或响应解析出现问题，会提供反馈信息。

## 要求

- **Microsoft Word**：支持VBA宏的任意版本。
- **通义API密钥**：需要从通义获取API密钥以进行请求验证。
- **网络访问**：用于发起API调用。

## 安装步骤

1. 打开Microsoft Word。
2. 按 `Alt + F11` 打开VBA编辑器。
3. 插入新模块（`插入 > 模块`）。
4. 将提供的VBA代码复制粘贴到模块中。
5. 将 `"your own API Key"` 替换为你实际的通义API密钥。
6. 将你的模型别名更改model中

## 使用方法

1. 在你的Word文档中选择想要发送到通义千问API的文本。
2. 运行 `TongyiV3` 宏（你可以将其分配给一个按钮或直接从VBA编辑器运行）。
3. 宏会使用来自通义千问API的AI生成内容替换选中的文本，同时确保正确的换行处理。

## 贡献

欢迎贡献！请随意fork此仓库，并通过pull请求提交改进或修复。对于重大更改，请先打开一个问题讨论你想要做的更改。

## 许可证

本项目基于MIT许可证 - 详情请参阅[LICENSE](./LICENSE)文件。